# PPT-Agent 开发计划

## 项目概述

**目标**: 构建一个AI驱动的PPT自动生成系统，用户通过选择模板和输入提示词（如"年终述职报告"），系统自动生成包含封面、目录、内容页和结束页的专业PPT。

**技术栈**: Python + python-pptx + LLM (OpenAI/Anthropic)

---

## 核心功能模块

### 1️⃣ 模板系统
- 设计可扩展的PPT模板JSON格式
- 支持导入真实PPT文件并解析为模板JSON
- 模板包含：版式定义、颜色方案、字体配置、占位符位置等

### 2️⃣ 大纲生成
- 使用LLM根据用户提示词生成PPT大纲
- 大纲结构化输出（JSON格式）
- 支持不同类型页面：封面、目录、内容页、结束页

### 3️⃣ PPT生成引擎
- 根据大纲数据和模板JSON生成PPT文件
- 自动排版和样式应用
- 支持图片、图表、表格等元素

### 4️⃣ 模板管理
- 模板导入功能（解析真实PPT）
- 模板列表和预览
- 模板验证和存储

---

## 工作计划

### 阶段一：项目架构设计 ✅
- [x] 创建项目开发计划
- [x] 定义开发规范文档
- [ ] 设计项目目录结构
- [ ] 定义核心数据模型

### 阶段二：模板系统设计与实现
- [ ] 设计PPT模板JSON Schema
  - [ ] 定义页面类型（封面、目录、内容、结束）
  - [ ] 定义布局结构（标题位置、内容区域、占位符）
  - [ ] 定义样式配置（颜色、字体、间距）
- [ ] 创建示例模板JSON文件
  - [ ] 商务风格模板
  - [ ] 简约风格模板
  - [ ] 学术风格模板
- [ ] 实现模板加载和验证功能
- [ ] 实现PPT解析器（真实PPT → 模板JSON）
  - [ ] 解析PPT结构和版式
  - [ ] 提取颜色方案和字体
  - [ ] 提取占位符位置信息
  - [ ] 生成标准化模板JSON

### 阶段三：大纲生成模块
- [ ] 设计大纲数据结构（JSON Schema）
  - [ ] 封面页数据结构
  - [ ] 目录页数据结构
  - [ ] 内容页数据结构
  - [ ] 结束页数据结构
- [ ] 实现LLM提示词工程
  - [ ] 设计System Prompt
  - [ ] 设计Few-shot示例
  - [ ] 实现结构化输出解析
- [ ] 实现大纲生成服务
  - [ ] 支持OpenAI API
  - [ ] 支持Anthropic API
  - [ ] 错误处理和重试机制
- [ ] 大纲验证和优化
  - [ ] 验证大纲完整性
  - [ ] 优化内容长度和布局适配

### 阶段四：PPT生成引擎
- [ ] 实现核心生成器
  - [ ] 封面页生成器
  - [ ] 目录页生成器
  - [ ] 内容页生成器（支持多种布局）
  - [ ] 结束页生成器
- [ ] 实现样式应用引擎
  - [ ] 颜色方案应用
  - [ ] 字体样式应用
  - [ ] 对齐和间距控制
- [ ] 实现内容渲染
  - [ ] 文本渲染和格式化
  - [ ] 列表和表格渲染
  - [ ] 图片占位符处理
- [ ] 自动排版优化
  - [ ] 文本溢出处理
  - [ ] 自适应字号调整
  - [ ] 内容分页逻辑

### 阶段五：Agent编排层
- [ ] 实现主Agent类
  - [ ] 流程编排（模板选择 → 大纲生成 → PPT生成）
  - [ ] 状态管理
  - [ ] 配置管理
- [ ] 实现用户交互接口
  - [ ] CLI命令行接口
  - [ ] API接口（可选）
- [ ] 实现输出管理
  - [ ] PPT文件保存
  - [ ] 大纲JSON导出
  - [ ] 日志记录

### 阶段六：测试与优化
- [ ] 单元测试
  - [ ] 模板加载测试
  - [ ] 大纲生成测试
  - [ ] PPT生成测试
- [ ] 集成测试
  - [ ] 端到端流程测试
  - [ ] 模板兼容性测试
- [ ] 性能优化
  - [ ] 生成速度优化
  - [ ] 内存使用优化
- [ ] 质量保证
  - [ ] 生成PPT美观性检查
  - [ ] 跨平台兼容性测试

### 阶段七：文档与部署
- [ ] 完善README文档
- [ ] 编写使用指南
- [ ] 编写模板开发指南
- [ ] 准备示例和Demo
- [ ] 打包和发布准备

---

## 技术难点与解决方案

### 难点1: PPT模板JSON设计
**挑战**: 需要设计一个既灵活又标准化的模板格式
**方案**: 
- 参考python-pptx的对象模型
- 使用相对坐标系统（百分比）而非绝对像素
- 分层设计：主题层 → 版式层 → 占位符层

### 难点2: 真实PPT解析
**挑战**: PPT格式复杂，难以完整解析所有元素
**方案**:
- 聚焦核心元素（文本框、形状、颜色）
- 使用python-pptx的内置属性
- 提供手动调整接口

### 难点3: LLM输出稳定性
**挑战**: LLM生成的内容可能不符合预期格式
**方案**:
- 使用结构化输出（JSON Mode/Function Calling）
- 多重验证和错误重试
- 提供回退方案和默认值

### 难点4: 自动排版
**挑战**: 不同长度的内容需要自适应布局
**方案**:
- 预定义多种内容长度模板
- 实现文本长度检测和字号自适应
- 必要时自动增加页面

---

## 数据模型设计

### 模板JSON结构示例
```json
{
  "template_id": "business_001",
  "template_name": "商务风格模板",
  "version": "1.0",
  "theme": {
    "colors": {
      "primary": "#1F4788",
      "secondary": "#F5A623",
      "accent": "#50E3C2",
      "text_dark": "#333333",
      "text_light": "#FFFFFF",
      "background": "#FFFFFF"
    },
    "fonts": {
      "title": {"name": "微软雅黑", "size": 44, "bold": true},
      "subtitle": {"name": "微软雅黑", "size": 28, "bold": false},
      "body": {"name": "微软雅黑", "size": 18, "bold": false}
    }
  },
  "layouts": {
    "cover": {
      "type": "cover",
      "placeholders": [
        {"id": "title", "type": "text", "x": 0.1, "y": 0.3, "width": 0.8, "height": 0.2},
        {"id": "subtitle", "type": "text", "x": 0.1, "y": 0.55, "width": 0.8, "height": 0.1},
        {"id": "author", "type": "text", "x": 0.1, "y": 0.75, "width": 0.8, "height": 0.05}
      ],
      "background": {"type": "solid", "color": "#1F4788"}
    },
    "toc": {
      "type": "table_of_contents",
      "placeholders": [
        {"id": "title", "type": "text", "x": 0.1, "y": 0.1, "width": 0.8, "height": 0.15},
        {"id": "items", "type": "list", "x": 0.15, "y": 0.3, "width": 0.7, "height": 0.6}
      ]
    },
    "content_single": {
      "type": "content",
      "placeholders": [
        {"id": "title", "type": "text", "x": 0.1, "y": 0.1, "width": 0.8, "height": 0.12},
        {"id": "content", "type": "text", "x": 0.1, "y": 0.25, "width": 0.8, "height": 0.65}
      ]
    },
    "ending": {
      "type": "ending",
      "placeholders": [
        {"id": "message", "type": "text", "x": 0.2, "y": 0.4, "width": 0.6, "height": 0.2}
      ],
      "background": {"type": "solid", "color": "#1F4788"}
    }
  }
}
```

### 大纲JSON结构示例
```json
{
  "outline_id": "annual_report_2023",
  "title": "2023年度工作述职报告",
  "author": "张三",
  "date": "2024年1月",
  "template_id": "business_001",
  "slides": [
    {
      "slide_number": 1,
      "layout_type": "cover",
      "content": {
        "title": "2023年度工作述职报告",
        "subtitle": "个人年度工作总结与展望",
        "author": "张三 | 产品部"
      }
    },
    {
      "slide_number": 2,
      "layout_type": "toc",
      "content": {
        "title": "目录",
        "items": [
          "年度工作回顾",
          "核心成果展示",
          "遇到的挑战",
          "2024年工作计划"
        ]
      }
    },
    {
      "slide_number": 3,
      "layout_type": "content_single",
      "content": {
        "title": "年度工作回顾",
        "content": "本年度主要负责产品规划和迭代管理，成功推动5个重大项目上线..."
      }
    },
    {
      "slide_number": 10,
      "layout_type": "ending",
      "content": {
        "message": "感谢聆听！"
      }
    }
  ],
  "metadata": {
    "total_slides": 10,
    "generated_at": "2024-01-15T10:30:00Z",
    "llm_model": "gpt-4"
  }
}
```

---

## 成功标准

1. ✅ 用户能通过简单提示词生成完整PPT
2. ✅ 生成的PPT包含封面、目录、内容、结束页
3. ✅ PPT视觉效果专业美观
4. ✅ 支持至少3种不同风格的模板
5. ✅ 能导入真实PPT并转换为模板
6. ✅ 整个生成流程在2分钟内完成
7. ✅ 代码测试覆盖率 > 80%

---

## 时间规划

- 阶段一：1天（架构设计）
- 阶段二：3天（模板系统）
- 阶段三：2天（大纲生成）
- 阶段四：4天（PPT生成引擎）
- 阶段五：2天（Agent编排）
- 阶段六：2天（测试优化）
- 阶段七：1天（文档部署）

**总计**: 约15个工作日

---

## 风险与应对

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| LLM API不稳定 | 高 | 实现重试机制，支持多个LLM提供商 |
| PPT格式兼容性问题 | 中 | 聚焦Office 2016+版本，提供兼容性测试 |
| 模板设计复杂度高 | 中 | 从简单模板开始，逐步增加复杂度 |
| 性能问题 | 低 | 异步处理，优化python-pptx调用 |

---

## 下一步行动

1. 审阅并确认此开发计划
2. 设置开发环境和依赖
3. 开始阶段二：设计第一个示例模板JSON
4. 实现模板加载器和验证器
